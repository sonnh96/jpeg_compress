<!DOCTYPE html>
<html>
<head>
    <title>Compress</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/jquery-ui.min.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/style.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static',filename='css/jquery.Jcrop.css') }}">
    <script type="text/javascript" src="{{ url_for('static',filename='js/jquery.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static',filename='js/jquery-ui.min.js') }}"></script>
    <script type="text/javascript" src="{{ url_for('static',filename='js/jquery.Jcrop.js') }}"></script>

</head>
<body>
<div class="title"><h1>Helloworld</h1></div>
<div class="content">
    <ul>
        <li><button class="btn_cpr">Compress</button></li>
        <li><button class="btn_crop">Crop</button></li>
    </ul>
    <img class="origin" id="target" src="{{ url_for('static',filename= 'images/origin/' + image) }}">
    <span>{{ size }}</span>
    <!--<form class="compress" action="/compress" method="post">-->
        <!--{{formCompress.hidden_tag()}}-->
        <!--{{formCompress.image}}-->
        <!--{{formCompress.size}}-->
        <!--<p> Enter the quality : {{formCompress.quality(size=5)}}</p>-->
        <!--<div class="slider"></div>-->
        <!--<p><input type="submit" value="Compress"></p>-->
    <!--</form>-->
    <form class="crop" action="/crop" method="post">
        {{formCrop.hidden_tag()}}
        {{formCrop.image}}
        {{formCrop.size}}
        <p>{{formCrop.x1}}</p>
        <p>{{formCrop.y1}}</p>
        <p>{{formCrop.x2}}</p>
        <p>{{formCrop.y2}}</p>
        <p>{{formCrop.height}}</p>
        <p>{{formCrop.width}}</p>
        <p><input type="submit" value="Crop"></p>
    </form>

    {% if posts %}
    <img src="{{ url_for('static',filename= 'images/compress/' + posts[0]) }}">
    <span>{{ posts[1] }}</span>
    {% endif %}
</div>

<script>
            $(document).ready(function(){
                $(".slider").slider(
                    {
                        value:50,
                        min: 0,
                        max: 100,
                        step: 1,
                        slide: function( event, ui ) {
                            $( "#quality" ).val(ui.value);
                        }
                    }
                );
                $("#image").val('{{ image }}');

                $("#size").val({{ size }});
            });
            $(".btn_crop").click(function(){
                var jcrop_api;
                $('#width').val($("#target").height());
                $('#height').val($("#target").width());
                $('#target').Jcrop({
                  onChange:   showCoords,
                  onSelect:   showCoords,
                  onRelease:  clearCoords
                },function(){
                  jcrop_api = this;
                });

                $('#coords').on('change','input',function(e){
                  var x1 = $('#x1').val(),
                      x2 = $('#x2').val(),
                      y1 = $('#y1').val(),
                      y2 = $('#y2').val();
                  jcrop_api.setSelect([x1,y1,x2,y2]);
                });

              });

              function showCoords(c)
              {
                $('#x1').val(c.x);
                $('#y1').val(c.y);
                $('#x2').val(c.x2);
                $('#y2').val(c.y2);

              };
              function clearCoords()
              {
                $('#coords input').val('');
              };
</script>
</body>
</html>
